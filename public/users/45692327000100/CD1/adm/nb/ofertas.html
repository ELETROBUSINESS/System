<!DOCTYPE html>
<html lang="pt-br" data-view="mobile">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loja ELETRO | D'TUDO</title>
    <link rel="icon" href="/assets/img/iconWeb.png">

    <!-- Bibliotecas Externas -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <link href='https://cdn-uicons.flaticon.com/2.6.0/uicons-solid-straight/css/uicons-solid-straight.css'
        rel='stylesheet'>
    <link href='https://cdn-uicons.flaticon.com/2.6.0/uicons-regular-rounded/css/uicons-regular-rounded.css'
        rel='stylesheet'>

    <!-- Estilos Unificados e Main -->
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="stylesheet" href="/assets/css/style26.css">

    <style>
        body {
            background-color: #f8f9fa;
            font-family: 'Inter', sans-serif;
            padding-bottom: 90px;
        }

        .product-card {
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
            padding: 16px;
            margin-bottom: 0;
            /* Grid handles gap, or manual margins for list */
            height: 100%;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
        }

        .product-card:active {
            transform: scale(0.98);
        }

        .highlight-price {
            color: var(--bs-color);
            font-weight: 800;
        }

        .rent-badge {
            background-color: #e0f2fe;
            color: var(--main);
            border-radius: 8px;
            padding: 4px 8px;
            font-size: 11px;
            font-weight: 600;
        }

        .trust-badge {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 10px;
            color: #16a34a;
            background: #dcfce7;
            padding: 4px 10px;
            border-radius: 20px;
            width: fit-content;
        }

        /* Grid Layout Responsive */
        .product-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            /* Mobile default */
            gap: 12px;
        }

        @media (min-width: 640px) {
            .product-grid {
                grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
                /* Adaptive on larger screens */
                gap: 20px;
                justify-content: center;
            }
        }

        /* Cart Badge */
        .cart-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background-color: #ef4444;
            color: white;
            font-size: 10px;
            font-weight: bold;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid white;
        }

        /* New Product Image Container */
        .product-image-container {
            width: 100%;
            aspect-ratio: 4/3;
            /* Consistent rectangular shape */
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            background-color: #fff;
            border-radius: 12px;
            border: 1px solid #f3f4f6;
            margin-bottom: 12px;
        }

        .product-image-container img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            padding: 8px;
            transition: transform 0.3s ease;
        }

        .product-card:hover .product-image-container img {
            transform: scale(1.05);
        }
    </style>
</head>

<body>

    <!-- Header Simples -->
    <!-- Header Simples -->
    <header class="fixed top-0 w-full bg-white/90 backdrop-blur-md z-50 shadow-sm transition-all duration-300">
        <div class="w-full max-w-4xl mx-auto px-4 md:px-8 py-4 flex items-center justify-between">
            <div class="flex items-center gap-3" onclick="window.history.back()">
                <i class='bx bx-arrow-back text-2xl text-gray-700 cursor-pointer'></i>
                <div>
                    <h1 class="text-lg font-bold text-gray-800 tracking-wide">ELETRO</h1>
                    <p class="text-[10px] text-gray-400 font-medium tracking-wider uppercase">Loja Oficial</p>
                </div>
            </div>
        </div>
    </header>

    <div id="shop-page" class="pt-24 px-4 md:px-8 w-full max-w-4xl mx-auto animate-[fadeIn_0.3s_ease] pb-32">

        <!-- User Profile (Minimalist) -->
        <!-- User Profile (Compact & Minimalist) -->
        <div
            class="bg-white rounded-xl p-3 shadow-sm mb-6 border border-gray-100 flex items-center justify-between w-full">
            <div class="flex items-center gap-3 min-w-0">
                <div
                    class="w-10 h-10 bg-blue-50 text-blue-600 rounded-full flex shrink-0 items-center justify-center font-bold text-xs border border-blue-100">
                    NU
                </div>
                <div class="min-w-0 flex-1">
                    <h2 class="text-xs font-bold text-gray-800 leading-tight truncate">A N F da Silva LTDA</h2>
                    <div class="flex items-center gap-1.5 text-[9px] text-gray-400 mt-0.5">
                        <span class="font-medium">Nubia</span>
                        <span class="w-0.5 h-0.5 bg-gray-300 rounded-full"></span>
                        <span class="font-mono truncate">45.692.327/0001-00</span>
                    </div>
                </div>
            </div>
            <div class="pl-4 border-l border-gray-100 shrink-0 text-right ml-2">
                <p class="text-[8px] text-gray-400 uppercase font-bold tracking-widest mb-0.5">Cashback</p>
                <div class="flex items-center justify-end gap-1">
                    <i class='bx bx-dollar-circle text-blue-600 text-sm'></i>
                    <span class="text-sm font-bold text-gray-800">R$ 0,00</span>
                </div>
            </div>
        </div>

        <!-- Seção: Uso em loja -->
        <div class="mb-4 mt-6">
            <h3 class="text-xs font-bold text-gray-400 uppercase tracking-widest">Uso em loja</h3>
        </div>

        <div class="product-grid">
            <!-- Produto 1: Leitor Fixo -->
            <div class="product-card">
                <div class="product-image-container">
                    <img src="https://http2.mlstatic.com/D_Q_NP_669652-MLA99474119254_112025-O.webp" alt="Leitor Fixo">
                </div>
                <div class="flex-1 flex flex-col">
                    <h2 class="text-xs font-bold text-gray-800 leading-tight mb-2 line-clamp-2">Leitor Código De Barras
                        Fixo Basic-model</h2>
                    <div class="mt-auto">
                        <p class="text-[10px] text-gray-400 line-through">R$ 234,90</p>
                        <p class="text-sm highlight-price text-black mb-2">R$ 234,90 <span
                                class="text-[10px] font-normal text-gray-500">ou 2x</span></p>

                        <div class="grid grid-cols-1 gap-2">
                            <button
                                onclick="addToCart('Leitor Fixo Basic-model', 234.90, 'https://http2.mlstatic.com/D_Q_NP_669652-MLA99474119254_112025-O.webp', 2, 16.90)"
                                class="w-full bg-blue-900 text-white py-2 rounded-lg text-xs font-bold shadow-sm hover:opacity-90 transition-all">
                                Adicionar
                            </button>
                            <div class="text-center bg-blue-50/50 rounded py-1 border border-blue-100/50">
                                <span class="text-[10px] text-blue-600 font-bold">Aluguel: R$ 16,90</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Produto: Leitor Baisec -->
            <div class="product-card">
                <div class="product-image-container">
                    <img src="https://http2.mlstatic.com/D_NQ_NP_2X_751925-MLB78325191660_082024-F.webp"
                        alt="Leitor Baisec">
                </div>
                <div class="flex-1 flex flex-col">
                    <h2 class="text-xs font-bold text-gray-800 leading-tight mb-2 line-clamp-2">Leitor De Codigo De
                        Barras Com Fio Baisec</h2>
                    <div class="mt-auto">
                        <p class="text-sm highlight-price text-black mb-2">R$ 97,90 <span
                                class="text-[10px] font-normal text-gray-500">ou 2x</span></p>
                        <div class="grid grid-cols-1 gap-2">
                            <button
                                onclick="addToCart('Leitor Com Fio Baisec', 97.90, 'https://http2.mlstatic.com/D_NQ_NP_2X_751925-MLB78325191660_082024-F.webp', 2, 9.90)"
                                class="w-full bg-blue-900 text-white py-2 rounded-lg text-xs font-bold shadow-sm hover:opacity-90 transition-all">
                                Adicionar
                            </button>
                            <div class="text-center bg-blue-50/50 rounded py-1 border border-blue-100/50">
                                <span class="text-[10px] text-blue-600 font-bold">Aluguel: R$ 9,90</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Produto: Leitor Exbom -->
            <div class="product-card">
                <div class="product-image-container">
                    <img src="https://http2.mlstatic.com/D_NQ_NP_2X_664423-MLA99533126136_122025-F.webp"
                        alt="Leitor Exbom">
                </div>
                <div class="flex-1 flex flex-col">
                    <h2 class="text-xs font-bold text-gray-800 leading-tight mb-2 line-clamp-2">Leitor De Código De
                        Barra Com Fio Exbom</h2>
                    <div class="mt-auto">
                        <p class="text-sm highlight-price text-black mb-2">R$ 117,49 <span
                                class="text-[10px] font-normal text-gray-500">ou 2x</span></p>
                        <div class="grid grid-cols-1 gap-2">
                            <button
                                onclick="addToCart('Leitor Exbom PCB-150', 117.49, 'https://http2.mlstatic.com/D_NQ_NP_2X_664423-MLA99533126136_122025-F.webp', 2, 11.90)"
                                class="w-full bg-blue-900 text-white py-2 rounded-lg text-xs font-bold shadow-sm hover:opacity-90 transition-all">
                                Adicionar
                            </button>
                            <div class="text-center bg-blue-50/50 rounded py-1 border border-blue-100/50">
                                <span class="text-[10px] text-blue-600 font-bold">Aluguel: R$ 11,90</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Produto: Kit PC -->
            <div class="product-card">
                <div class="product-image-container">
                    <img src="https://m.magazineluiza.com.br/a-static/420x420/computador-completo-intel-core-i5-8gb-hd-500gb-monitor-hdmi-19-5-windows-10-quantum-flex/3greentechnology/39851/1fc652c085a4844458a3cd9e01f200ab.jpeg"
                        alt="Kit PC">
                </div>
                <div class="flex-1 flex flex-col">
                    <h2 class="text-xs font-bold text-gray-800 leading-tight mb-2 line-clamp-2">Kit Computador p/ Ponto
                        de Venda</h2>
                    <div class="mt-auto">
                        <p class="text-[10px] text-gray-400 line-through">R$ 1.300,90</p>
                        <p class="text-sm highlight-price text-black mb-2">R$ 1.097,90 <span
                                class="text-[10px] font-normal text-gray-500">ou 4x</span></p>
                        <button
                            onclick="addToCart('Kit Computador PDV', 1097.90, 'https://m.magazineluiza.com.br/a-static/420x420/computador-completo-intel-core-i5-8gb-hd-500gb-monitor-hdmi-19-5-windows-10-quantum-flex/3greentechnology/39851/1fc652c085a4844458a3cd9e01f200ab.jpeg', 4)"
                            class="w-full bg-blue-900 text-white py-2 rounded-lg text-xs font-bold shadow-sm hover:opacity-90 transition-all">
                            Adicionar
                        </button>
                    </div>
                </div>
            </div>

            <!-- Produto: Leitor Knup -->
            <div class="product-card">
                <div class="product-image-container">
                    <img src="https://http2.mlstatic.com/D_NQ_NP_2X_910337-MLA95493924308_102025-F.webp"
                        alt="Leitor Knup">
                </div>
                <div class="flex-1 flex flex-col">
                    <h2 class="text-xs font-bold text-gray-800 leading-tight mb-2 line-clamp-2">Leitor De Código De
                        Barras Knup</h2>
                    <div class="mt-auto">
                        <p class="text-sm highlight-price text-black mb-2">R$ 159,90 <span
                                class="text-[10px] font-normal text-gray-500">ou 2x</span></p>
                        <div class="grid grid-cols-1 gap-2">
                            <button
                                onclick="addToCart('Leitor Knup Com Suporte', 159.90, 'https://http2.mlstatic.com/D_NQ_NP_2X_910337-MLA95493924308_102025-F.webp', 2, 14.20)"
                                class="w-full bg-blue-900 text-white py-2 rounded-lg text-xs font-bold shadow-sm hover:opacity-90 transition-all">
                                Adicionar
                            </button>
                            <div class="text-center bg-blue-50/50 rounded py-1 border border-blue-100/50">
                                <span class="text-[10px] text-blue-600 font-bold">Aluguel: R$ 14,20</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Produto: Camera Kateluo -->
            <div class="product-card">
                <div class="product-image-container">
                    <img src="https://http2.mlstatic.com/D_NQ_NP_2X_711866-MLA101431313907_122025-F.webp" alt="Camera">
                </div>
                <div class="flex-1 flex flex-col">
                    <h2 class="text-xs font-bold text-gray-800 leading-tight mb-2 line-clamp-2">Câmera De Segurança
                        Smart Ip Wifi</h2>
                    <div class="mt-auto">
                        <p class="text-[10px] text-gray-400 line-through">R$ 155,79</p>
                        <p class="text-sm highlight-price text-black mb-2">R$ 134,90</p>
                        <button
                            onclick="addToCart('Câmera Smart Ip Wifi Kateluo', 134.90, 'https://http2.mlstatic.com/D_NQ_NP_2X_711866-MLA101431313907_122025-F.webp', 1)"
                            class="w-full bg-blue-900 text-white py-2 rounded-lg text-xs font-bold shadow-sm hover:opacity-90 transition-all">
                            Adicionar
                        </button>
                    </div>
                </div>
            </div>

            <!-- Produto: Leitor Sem Fio -->
            <div class="product-card">
                <div class="product-image-container">
                    <img src="https://images.tcdn.com.br/img/img_prod/1214924/leitor_de_codigo_de_barra_sem_fio_a_1484_24110_2_6d75d135ebccafeb787ef6452efded8b.jpg"
                        alt="Leitor Sem Fio">
                </div>
                <div class="flex-1 flex flex-col">
                    <h2 class="text-xs font-bold text-gray-800 leading-tight mb-2 line-clamp-2">Leitor Sem Fio
                        Livre-Avance</h2>
                    <div class="mt-auto">
                        <p class="text-[10px] text-gray-400 line-through">R$ 199,99</p>
                        <p class="text-sm highlight-price text-black mb-2">R$ 199,99 <span
                                class="text-[10px] font-normal text-gray-500">ou 2x</span></p>
                        <div class="grid grid-cols-1 gap-2">
                            <button
                                onclick="addToCart('Leitor Sem Fio Livre-Avance', 199.99, 'https://images.tcdn.com.br/img/img_prod/1214924/leitor_de_codigo_de_barra_sem_fio_a_1484_24110_2_6d75d135ebccafeb787ef6452efded8b.jpg', 2, 12.90)"
                                class="w-full bg-blue-900 text-white py-2 rounded-lg text-xs font-bold shadow-sm hover:opacity-90 transition-all">
                                Adicionar
                            </button>
                            <div class="text-center bg-blue-50/50 rounded py-1 border border-blue-100/50">
                                <span class="text-[10px] text-blue-600 font-bold">Aluguel: R$ 12,90</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Produto: Bobina -->
            <div class="product-card">
                <div class="product-image-container">
                    <img src="https://http2.mlstatic.com/D_NQ_NP_2X_884338-MLB92318976611_092025-F.webp" alt="Bobina">
                </div>
                <div class="flex-1 flex flex-col">
                    <h2 class="text-xs font-bold text-gray-800 leading-tight mb-2 line-clamp-2">6 Rolos Bobina Epson
                        Tm-t20x</h2>
                    <div class="mt-auto">
                        <p class="text-[10px] text-gray-400 line-through">R$ 99,90</p>
                        <p class="text-sm highlight-price text-black mb-2">R$ 87,90</p>
                        <button
                            onclick="addToCart('6 Rolos Bobina Epson Tm-t20x', 87.90, 'https://http2.mlstatic.com/D_NQ_NP_2X_884338-MLB92318976611_092025-F.webp', 1)"
                            class="w-full bg-blue-900 text-white py-2 rounded-lg text-xs font-bold shadow-sm hover:opacity-90 transition-all">
                            Adicionar
                        </button>
                    </div>
                </div>
            </div>

            <!-- Produto: Teclado -->
            <div class="product-card">
                <div class="product-image-container">
                    <img src="https://http2.mlstatic.com/D_Q_NP_735713-MLA99973706633_112025-F.webp" alt="Teclado">
                </div>
                <div class="flex-1 flex flex-col">
                    <h2 class="text-xs font-bold text-gray-800 leading-tight mb-2 line-clamp-2">Kit Teclado e Mouse
                        Logtech</h2>
                    <div class="mt-auto">
                        <p class="text-[10px] text-gray-400 line-through">R$ 179,90</p>
                        <p class="text-sm highlight-price text-black mb-2">R$ 164,90</p>
                        <button
                            onclick="addToCart('Kit Teclado e Mouse Logtech', 164.90, 'https://http2.mlstatic.com/D_Q_NP_735713-MLA99973706633_112025-F.webp', 1)"
                            class="w-full bg-blue-900 text-white py-2 rounded-lg text-xs font-bold shadow-sm hover:opacity-90 transition-all">
                            Adicionar
                        </button>
                    </div>
                </div>
            </div>

            <!-- Produto: Crachá -->
            <div class="product-card">
                <div class="product-image-container">
                    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEjfF_2HVi3Cb--rTz-wnIG5NobrMX3oid8J0cecE_wOcqhF1rsibATsVTnThQshupdNtvPeTO1LETgWiMgGhNXTlVpLHO0Na-iGcO-GAdXmbEwolZFun8hI7rNdZ_6JOuW03ZR8EkAK_z8QRqHpGZn5Wo9EbVGj21_e0MSy1CJRwf1pVmV-bOXvaCDnIxY"
                        alt="Crachá">
                </div>
                <div class="flex-1 flex flex-col">
                    <h2 class="text-xs font-bold text-gray-800 leading-tight mb-2 line-clamp-2">Crachá Personalizado
                        D'Tudo</h2>
                    <div class="mt-auto">
                        <p class="text-sm highlight-price text-black mb-2">R$ 29,90 <span
                                class="text-[10px] font-normal text-gray-500">un</span></p>
                        <button
                            onclick="addToCart('Crachá Personalizado', 29.90, 'https://blogger.googleusercontent.com/img/a/AVvXsEjfF_2HVi3Cb--rTz-wnIG5NobrMX3oid8J0cecE_wOcqhF1rsibATsVTnThQshupdNtvPeTO1LETgWiMgGhNXTlVpLHO0Na-iGcO-GAdXmbEwolZFun8hI7rNdZ_6JOuW03ZR8EkAK_z8QRqHpGZn5Wo9EbVGj21_e0MSy1CJRwf1pVmV-bOXvaCDnIxY', 1)"
                            class="w-full bg-blue-900 text-white py-2 rounded-lg text-xs font-bold shadow-sm hover:opacity-90 transition-all">
                            Adicionar
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Seção: Revenda -->
        <div class="mt-8 mb-4">
            <h3 class="text-xs font-bold text-gray-400 uppercase tracking-widest">Revenda</h3>


            <!-- Revenda Produto 1 -->
            <div class="product-card mt-4">
                <div class="mb-4 flex gap-4">
                    <div
                        class="w-24 h-24 bg-white rounded-lg flex items-center justify-center border border-gray-100 overflow-hidden relative shadow-sm">
                        <img src="https://lojavisual.com/cdn/shop/files/D_NQ_NP_2X_884817-MLB92511831611_092025-F-kit-36-canetinhas-ponta-dupla-coloridas-para-desenho.webp?v=1757968127"
                            class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 max-w-[90%] max-h-[90%] object-contain">
                    </div>
                    <div class="flex-1">
                        <h2 class="text-sm font-bold text-gray-800 leading-tight mb-1">Canetinha Touch 36 Un</h2>
                        <p class="text-[10px] text-blue-600 mb-1 font-bold"><i class='bx bxs-badge-check'></i> SUPREO
                        </p>
                        <p class="text-[9px] text-gray-400 mb-2">+500mil vendas | a pronta entrega</p>
                    </div>
                </div>

                <div class="border-t border-gray-100 pt-3">
                    <div class="flex justify-between items-end">
                        <div>
                            <p class="text-[10px] text-gray-400">Limite: 1 unidade</p>
                            <p class="text-lg highlight-price text-black">R$ 23,90 <span
                                    class="text-xs text-gray-500 font-normal">un</span></p>
                        </div>
                        <button onclick="comprarProduto('Canetinha Touch 36 Un (Promo)', 23.90, false, 1, true)"
                            class="bg-blue-900 text-white px-4 py-2 rounded-lg text-xs font-bold shadow-md hover:opacity-90 transition-opacity">
                            Comprar
                        </button>
                    </div>
                </div>
            </div>

            <!-- Revenda Produto 2 -->
            <div class="product-card mt-4">
                <div class="mb-4 flex gap-4">
                    <div
                        class="w-24 h-24 bg-white rounded-lg flex items-center justify-center border border-gray-100 overflow-hidden relative shadow-sm">
                        <img src="https://lojavisual.com/cdn/shop/files/D_NQ_NP_2X_884817-MLB92511831611_092025-F-kit-36-canetinhas-ponta-dupla-coloridas-para-desenho.webp?v=1757968127"
                            class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 max-w-[90%] max-h-[90%] object-contain">
                    </div>
                    <div class="flex-1">
                        <h2 class="text-sm font-bold text-gray-800 leading-tight mb-1">Canetinha Touch 36 Un</h2>
                        <p class="text-[10px] text-blue-600 mb-1 font-bold"><i class='bx bxs-badge-check'></i> SUPREO
                        </p>
                        <p class="text-[9px] text-gray-400 mb-2">+500mil vendas</p>
                    </div>
                </div>

                <div class="border-t border-gray-100 pt-3">
                    <div class="flex justify-between items-end">
                        <div>
                            <p class="text-[10px] text-gray-400">Limite: 5 unidades</p>
                            <p class="text-lg highlight-price text-black">R$ 24,90 <span
                                    class="text-xs text-gray-500 font-normal">un</span></p>
                        </div>
                        <button onclick="comprarProduto('Canetinha Touch 36 Un', 24.90, false, 5, false)"
                            class="bg-blue-900 text-white px-4 py-2 rounded-lg text-xs font-bold shadow-md hover:opacity-90 transition-opacity">
                            Comprar
                        </button>
                    </div>
                </div>
            </div>
            <!-- Revenda Produto 3 -->
            <div class="product-card mt-4">
                <div class="mb-4 flex gap-4">
                    <div
                        class="w-24 h-24 bg-white rounded-lg flex items-center justify-center border border-gray-100 overflow-hidden relative shadow-sm">
                        <img src="https://www.papelariaartnova.com.br/img/products/caneta-marcador-permanente-ponta-dupla-estojo-c-48-cores-touch_1_600.png"
                            class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 max-w-[90%] max-h-[90%] object-contain">
                    </div>
                    <div class="flex-1">
                        <h2 class="text-sm font-bold text-gray-800 leading-tight mb-1">Canetinha Touch 48 Un</h2>
                        <p class="text-[10px] text-blue-600 mb-1 font-bold"><i class='bx bxs-badge-check'></i> SUPREO
                        </p>
                        <p class="text-[9px] text-gray-400 mb-2">+500mil vendas</p>
                    </div>
                </div>

                <div class="border-t border-gray-100 pt-3">
                    <div class="flex justify-between items-end">
                        <div>
                            <p class="text-[10px] text-gray-400">Limite: 5 unidades</p>
                            <p class="text-lg highlight-price text-black">R$ 29,90 <span
                                    class="text-xs text-gray-500 font-normal">un</span></p>
                        </div>
                        <button onclick="comprarProduto('Canetinha Touch 48 Un', 29.90, false, 5, false)"
                            class="bg-blue-900 text-white px-4 py-2 rounded-lg text-xs font-bold shadow-md hover:opacity-90 transition-opacity">
                            Comprar
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Toast Container -->
        <div id="toast-container"
            style="position: fixed; top: 20px; left: 50%; transform: translateX(-50%); z-index: 3000; display: flex; flex-direction: column; gap: 10px; width: 90%; max-width: 350px; pointer-events: none;">
        </div>

        <!-- Modal Pagamento -->
        <div id="modalPagamento" class="modal"
            style="display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.6); z-index: 2000; align-items: flex-end; justify-content: center;">
            <div
                class="bg-white w-full max-w-[500px] rounded-t-3xl p-6 shadow-2xl animate-[slideInUp_0.3s_ease] relative">

                <!-- Close Button -->
                <button onclick="fecharModal()"
                    class="absolute top-4 right-4 p-2 bg-gray-100 rounded-full text-gray-500 hover:bg-gray-200 transition-colors">
                    <i class='bx bx-x text-xl'></i>
                </button>

                <div class="text-center mb-6 mt-2">
                    <div
                        class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-3 text-blue-600">
                        <i class='bx bx-check-shield text-2xl'></i>
                    </div>
                    <h2 class="text-xl font-bold text-gray-800">Finalizar Compra</h2>
                    <p class="text-xs text-gray-500 mt-1">Ambiente seguro verificado</p>
                </div>

                <div class="bg-gray-50 p-4 rounded-xl mb-6 border border-gray-100">
                    <div class="flex justify-between items-start mb-2">
                        <div>
                            <p class="text-[10px] font-bold text-gray-400 uppercase tracking-widest mb-1">Produto</p>
                            <h3 id="pagamento-descricao" class="text-sm font-semibold text-gray-800 leading-tight">...
                            </h3>
                        </div>
                    </div>
                    <div class="border-t border-gray-200 my-3"></div>
                    <div class="flex justify-between items-end">
                        <span class="text-xs font-medium text-gray-500">Total a pagar:</span>
                        <h2 id="pagamento-valor" class="text-2xl font-bold text-black leading-none">...</h2>
                    </div>
                </div>

                <div id="payment-area">
                    <div class="space-y-3">
                        <div class="flex items-center gap-3 p-3 border border-blue-200 bg-blue-50 rounded-lg">
                            <i class='bx bx-qr text-2xl text-blue-600'></i>
                            <div>
                                <p class="text-sm font-bold text-gray-800">Pix Instantâneo</p>
                                <p class="text-[10px] text-blue-700">Aprovação imediata</p>
                            </div>
                            <div class="ml-auto">
                                <i class='bx bxs-check-circle text-blue-600 text-lg'></i>
                            </div>
                        </div>
                    </div>

                    <button id="btnGerarPix" onclick="gerarPagamento()"
                        class="w-full mt-6 bg-[var(--bs-color)] text-white py-4 rounded-xl font-bold text-base shadow-lg hover:opacity-90 transition-all flex items-center justify-center gap-2">
                        <i class='bx bx-lock-alt'></i> Comprar Agora
                    </button>

                    <p class="text-[10px] text-center text-gray-400 mt-4 flex items-center justify-center gap-1">
                        <i class='bx bx-shield-quarter'></i> Seus dados estão protegidos.
                    </p>
                </div>
            </div>
        </div>
        <!-- Seção: Itens Adquiridos (Moved to Bottom) -->
        <div class="product-card mt-8 mb-6">
            <h3 class="text-xs font-bold text-gray-800 uppercase tracking-widest mb-4 border-b border-gray-100 pb-2">
                Itens Adquiridos</h3>

            <!-- Item 1 -->
            <div class="flex items-center gap-4 py-3 border-b border-gray-50 last:border-0">
                <div class="w-10 h-10 rounded-lg bg-blue-50 flex items-center justify-center text-blue-600">
                    <i class='bx bx-barcode text-xl'></i>
                </div>
                <div class="flex-1">
                    <h4 class="text-sm font-bold text-gray-800">Leitor de código de Barras c/fio</h4>
                    <div class="flex items-center gap-2 mt-1">
                        <span class="text-xs text-gray-400 line-through">Mensal: R$ 13,90</span>
                        <span class="text-xs font-bold text-blue-600">R$ 0,00</span>
                    </div>
                    <p class="text-[10px] text-blue-500 font-medium mt-2">Benefício de subsídio | Gilvan</p>
                </div>
                <div class="text-right">
                    <p class="text-sm font-bold text-gray-800">R$ 99,90</p>
                    <span class="text-[10px] font-bold text-gray-400 uppercase tracking-wide">Adquirido</span>
                </div>
            </div>

            <!-- Item 2 -->
            <div class="flex items-center gap-4 py-3">
                <div class="w-10 h-10 rounded-lg bg-blue-50 flex items-center justify-center text-blue-600">
                    <i class='bx bx-purchase-tag-alt text-xl'></i>
                </div>
                <div class="flex-1">
                    <h4 class="text-sm font-bold text-gray-800">Etiquetadora de preços</h4>
                    <div class="flex items-center gap-2 mt-1">
                        <span class="text-xs text-gray-400 line-through">Mensal: R$ 9,90</span>
                        <span class="text-xs font-bold text-blue-600">R$ 0,00</span>
                    </div>
                    <p class="text-[10px] text-blue-500 font-medium mt-2">Benefício de subsídio | Gilvan</p>
                </div>
                <div class="text-right">
                    <p class="text-sm font-bold text-gray-800">R$ 79,90</p>
                    <span class="text-[10px] font-bold text-gray-400 uppercase tracking-wide">Adquirido</span>
                </div>
            </div>
        </div>
    </div> <!-- End of Shop Page -->

    <!-- Orders Page -->
    <div id="orders-page" class="pt-24 px-4 md:px-8 w-full max-w-4xl mx-auto hidden animate-[fadeIn_0.3s_ease]">

        <h2 class="text-lg font-bold text-gray-800 mb-4 px-2">Meus Pedidos</h2>

        <div id="dynamic-orders"></div>

        <!-- Order 1 -->
        <div class="bg-white rounded-2xl p-5 shadow-sm mb-4 border border-gray-100">
            <div class="flex gap-4">
                <div class="w-16 h-16 bg-blue-50 rounded-xl flex items-center justify-center text-blue-500">
                    <i class='bx bx-cube text-2xl'></i>
                </div>
                <div class="flex-1">
                    <p class="text-[10px] uppercase font-bold text-blue-900 mb-1 tracking-wide">Em Trânsito</p>
                    <h3 class="text-sm font-bold text-gray-800 leading-tight">ELETRO • Suporte A.AQUA V83B PT</h3>
                    <p class="text-xs text-gray-500 mt-1">2x R$ 114,95</p>
                </div>
            </div>

            <div class="mt-4 pt-4 border-t border-gray-100">
                <div class="flex items-start gap-3">
                    <div class="flex flex-col items-center gap-1 mt-1">
                        <div class="w-2 h-2 rounded-full bg-gray-300"></div>
                        <div class="w-0.5 h-6 bg-gray-200"></div>
                        <div class="w-2 h-2 rounded-full bg-blue-600"></div>
                    </div>
                    <div class="flex-1 space-y-4">
                        <div>
                            <p class="text-xs font-bold text-gray-700">Localização Atual</p>
                            <p class="text-xs text-gray-500">Galpão Logístico em Belém</p>
                        </div>
                        <div>
                            <p class="text-xs font-bold text-gray-700">Previsão de Entrega</p>
                            <p class="text-xs text-gray-500">16 a 19 de fevereiro</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Order 2 -->
        <div class="bg-white rounded-2xl p-5 shadow-sm mb-4 border border-gray-100 opacity-80">
            <div class="flex gap-4">
                <div class="w-16 h-16 bg-gray-100 rounded-xl flex items-center justify-center text-gray-500">
                    <i class='bx bx-check text-2xl'></i>
                </div>
                <div class="flex-1">
                    <p class="text-[10px] uppercase font-bold text-gray-500 mb-1 tracking-wide">Entregue</p>
                    <h3 class="text-sm font-bold text-gray-800 leading-tight">Adaptador Bluetooth Conector Pc</h3>
                    <p class="text-xs text-gray-500 mt-1">R$ 35,00</p>
                </div>
            </div>

            <div class="mt-4 pt-4 border-t border-gray-100">
                <div class="mb-3">
                    <p class="text-xs font-bold text-gray-700">Entregue em:</p>
                    <p class="text-xs text-gray-500">D'Tudo Variedades, Jarbas Passarinho, Ipixuna do Pará.</p>
                </div>
                <div>
                    <p class="text-xs font-bold text-gray-700">Local da nota fiscal:</p>
                    <div class="flex items-center gap-2 mt-1">
                        <i class='bx bxs-file-pdf text-blue-900'></i>
                        <span class="text-xs text-gray-500">Nota Fiscal (R$ 35,00)</span>
                        <span class="text-xs text-gray-500">Nota Fiscal (R$ 35,00)</span>
                        <button onclick="openInvoice()"
                            class="text-[10px] font-bold text-blue-600 uppercase ml-auto hover:underline cursor-pointer bg-transparent border-none p-0">Visualizar</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Cart Page (New) -->
    <div id="cart-page" class="pt-24 px-4 md:px-8 w-full max-w-4xl mx-auto hidden animate-[fadeIn_0.3s_ease]">
        <!-- Cart Content Will Be Injected Here via JS -->
    </div>

    <!-- Floating Navbar -->
    <!-- Floating Navbar (Redesigned) -->
    <div
        class="fixed bottom-6 left-1/2 -translate-x-1/2 w-[90%] max-w-[350px] bg-white/90 backdrop-blur-xl border border-white/40 shadow-2xl rounded-2xl px-2 py-3 flex items-center justify-evenly z-50">
        <button onclick="switchPage('shop')" id="nav-shop"
            class="flex flex-col items-center gap-1 text-blue-900 transition-all active:scale-95 w-12">
            <i class='bx bx-store-alt text-2xl'></i>
        </button>

        <button onclick="switchPage('cart')" id="nav-cart"
            class="relative flex flex-col items-center gap-1 text-gray-400 hover:text-blue-900 transition-all active:scale-95 w-12">
            <i class='bx bx-basket text-2xl'></i>
            <span id="cart-count"
                class="absolute -top-1 -right-1 bg-red-500 text-white text-[10px] font-bold w-4 h-4 rounded-full flex items-center justify-center border border-white hidden">0</span>
        </button>

        <button onclick="switchPage('orders')" id="nav-orders"
            class="flex flex-col items-center gap-1 text-gray-400 hover:text-blue-900 transition-all active:scale-95 w-12">
            <i class='bx bx-map-alt text-2xl'></i>
        </button>

        <button onclick="switchPage('card')" id="nav-card"
            class="flex flex-col items-center gap-1 text-gray-400 hover:text-blue-900 transition-all active:scale-95 w-12">
            <i class='bx bx-credit-card text-2xl'></i>
        </button>
    </div>

    <!-- Digital Card Page (High Fidelity) -->
    <div id="card-page" class="hidden animate-[fadeIn_0.3s_ease] pb-32 w-full h-full bg-[#f3f4f6]"
        style="position:fixed; top:0; left:0; z-index:45; overflow-y:auto; padding-top: 80px;">
        <div class="w-full max-w-4xl mx-auto px-6 md:px-8">
            <!-- Header -->
            <header class="flex justify-between items-center mb-10">
                <div>
                    <span class="text-slate-400 font-bold text-xs uppercase tracking-[0.2em] block">Meus Acessos</span>
                    <h2 class="text-2xl font-black text-slate-900 tracking-tighter">Nubia</h2>
                </div>
                <div
                    class="w-14 h-14 rounded-3xl bg-white shadow-lg flex items-center justify-center border border-slate-50">
                    <i class='bx bx-cog text-2xl text-slate-600'></i>
                </div>
            </header>

            <!-- Credit Card -->
            <section class="mb-10 flex justify-center">
                <div
                    class="holographic-card w-full max-w-md rounded-[40px] p-8 text-white aspect-[1.6/1] flex flex-col justify-between shadow-2xl relative overflow-hidden bg-gradient-to-br from-blue-900 via-blue-700 to-blue-900">
                    <!-- Holographic Overlay -->
                    <div
                        class="absolute inset-0 bg-gradient-to-tr from-transparent via-white/10 to-transparent opacity-30 pointer-events-none">
                    </div>

                    <div class="flex justify-between items-start z-10 relative">
                        <div class="flex items-center gap-3">
                            <div
                                class="w-12 h-12 bg-white/20 backdrop-blur-xl rounded-2xl flex items-center justify-center text-white">
                                <i class='bx bx-chip text-3xl opacity-80'></i>
                            </div>
                            <span class="font-black text-sm tracking-tighter uppercase opacity-90 text-blue-100">Cartão
                                Platinum</span>
                        </div>
                        <span class="text-2xl font-black italic tracking-tighter text-white">ELETRO</span>
                    </div>

                    <div class="z-10 relative">
                        <span
                            class="text-[10px] font-black uppercase tracking-widest opacity-60 block mb-1 text-blue-200">Fatura
                            em Aberto</span>
                        <div class="text-4xl font-black tracking-tighter mb-6 text-white" id="card-hero-invoice">R$ 0,00
                        </div>

                        <div class="flex justify-between items-end">
                            <div class="font-mono text-lg tracking-[0.2em] opacity-80 text-blue-100">•••• •••• ••••
                                <span id="card-last-digits">1029</span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Limits Section -->
            <section class="bg-white rounded-[40px] p-8 shadow-lg mb-10 shadow-slate-200/50 max-w-md mx-auto">
                <div class="flex justify-between items-center mb-6">
                    <h4 class="text-sm font-black text-slate-900 uppercase tracking-widest">Limite de Crédito</h4>
                    <div id="card-val-avail" class="text-emerald-500 font-black text-xs uppercase tracking-widest">
                        Carregando...</div>
                </div>

                <div class="h-4 bg-slate-50 rounded-full flex overflow-hidden p-1 shadow-inner mb-6">
                    <div id="card-bar-current"
                        class="h-full bg-blue-600 rounded-full transition-all duration-1000 shadow-lg shadow-blue-200"
                        style="width: 0%"></div>
                    <div id="card-bar-future"
                        class="h-full bg-amber-400 rounded-full transition-all duration-1000 ml-0.5" style="width: 0%">
                    </div>
                </div>

                <div class="flex justify-between">
                    <div>
                        <p class="text-[10px] font-black text-slate-400 uppercase tracking-widest mb-1">Total Utilizado
                        </p>
                        <p id="card-limit-total-text" class="text-xl font-black text-slate-900 tracking-tighter">R$ 0,00
                        </p>
                    </div>
                    <div class="text-right">
                        <p class="text-[10px] font-black text-slate-400 uppercase tracking-widest mb-1">Limite Total</p>
                        <p class="text-xl font-black text-slate-300 tracking-tighter">R$ 2.000,00</p>
                    </div>
                </div>
            </section>

            <!-- Invoice List -->
            <section class="mb-32">
                <div class="flex justify-between items-center mb-8">
                    <h3 class="text-lg font-black text-slate-900 tracking-tighter">Minhas Faturas</h3>
                    <span
                        class="text-xs font-bold text-blue-600 bg-blue-50 px-3 py-1 rounded-full uppercase tracking-widest">Ver
                        Tudo</span>
                </div>

                <div id="card-invoices-carousel"
                    class="flex overflow-x-auto gap-5 pb-10 -mx-6 px-6 snap-x hide-scrollbar">
                    <!-- Items via JS -->
                    <button class="text-blue-600 text-[10px] font-bold uppercase tracking-wide hidden">Ver
                        Detalhes</button>
                    <div id="installments-list" class="w-full"></div>
                </div>
            </section>
        </div>
    </div>

    <!-- Purchase Animation Overlay -->
    <div id="purchase-overlay" class="fixed inset-0 z-[3000] hidden items-center justify-center overflow-hidden">
        <!-- Expanding Sphere -->
        <div id="purchase-sphere"
            class="absolute w-10 h-10 bg-blue-900 rounded-full transform scale-0 transition-transform duration-700 ease-in-out">
        </div>

        <!-- Content -->
        <div id="purchase-content"
            class="relative z-10 flex flex-col items-center text-white opacity-0 transition-opacity duration-500 delay-300">
            <h2 class="text-3xl font-bold text-center px-4">Já é quase seu...</h2>
            <div class="mt-6 w-12 h-12 border-4 border-white/30 border-t-white rounded-full animate-spin"></div>
        </div>
    </div>

    <!-- Invoice Modal Removed (Opened in new tab instead) -->

    <script>
        let cart = [];
        const toastContainer = document.getElementById('toast-container');

        // ... (existing code remains until utils) ...

        // Helper to render the specific Cart UI into the modal (Obsolete)

        // --- Core Logic ---


        function calculateProRata(monthlyPrice) {
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            const currentYear = today.getFullYear();
            const currentMonth = today.getMonth();
            let targetDate = new Date(currentYear, currentMonth, 23);
            targetDate.setHours(0, 0, 0, 0);

            if (today.getTime() > targetDate.getTime()) {
                targetDate = new Date(currentYear, currentMonth + 1, 23);
                targetDate.setHours(0, 0, 0, 0);
            }

            const diffTime = Math.abs(targetDate - today);
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            const dailyRate = monthlyPrice / 30;
            return {
                days: diffDays,
                price: dailyRate * diffDays
            };
        }

        function addToCart(name, price, img, maxInstallments = 1, rentPrice = 0) {
            const id = Date.now().toString(36) + Math.random().toString(36).substr(2);
            cart.push({
                id,
                name,
                basePrice: price,
                img,
                maxInstallments,
                rentPrice,
                type: 'buy', // 'buy' or 'rent'
                installments: 1, // 1 to maxInstallments
                quantity: 1
            });
            updateCartIcon();
            showToast('Adicionado ao carrinho!', 'success');
        }

        // Adapter for Legacy calls (Revenda Section)
        function comprarProduto(nome, valor, isRental, maxQty, allowInstallments) {
            addToCart(nome, valor, '', allowInstallments ? 2 : 1, 0);
        }

        function updateCartIcon() {
            const el = document.getElementById('cart-count');
            const nav = document.getElementById('nav-cart');
            el.innerText = cart.length;
            if (cart.length > 0) {
                el.classList.remove('hidden');
                nav.classList.add('text-blue-900');
                nav.classList.remove('text-gray-400');
            } else {
                el.classList.add('hidden');
                nav.classList.remove('text-blue-900');
                nav.classList.add('text-gray-400');
            }
        }

        function removeFromCart(id) {
            cart = cart.filter(item => item.id !== id);
            renderCartItems();
            updateCartIcon();
        }

        function updateItemType(id, type) {
            const item = cart.find(i => i.id === id);
            if (item) {
                item.type = type;
                item.installments = 1; // Reset installments on type change
                renderCartItems(); // Re-render to show/hide installment selector
            }
        }

        function updateItemInstallments(id, n) {
            const item = cart.find(i => i.id === id);
            if (item) {
                item.installments = parseInt(n);
                renderCartItems(); // Re-render to update totals
            }
        }

        // --- Cart Modal & rendering ---

        // --- Cart Page & Rendering ---

        // --- Cart Page & Rendering ---

        function switchPage(page) {
            const shopPage = document.getElementById('shop-page');
            const ordersPage = document.getElementById('orders-page');
            const cartPage = document.getElementById('cart-page');
            const cardPage = document.getElementById('card-page');

            const navShop = document.getElementById('nav-shop');
            const navOrders = document.getElementById('nav-orders');
            const navCart = document.getElementById('nav-cart');
            const navCard = document.getElementById('nav-card');

            // Reset
            [shopPage, ordersPage, cartPage, cardPage].forEach(el => el && el.classList.add('hidden'));
            [navShop, navOrders, navCart, navCard].forEach(el => {
                if (el) {
                    el.classList.remove('text-blue-900');
                    el.classList.add('text-gray-400');
                }
            });

            // Active
            if (page === 'shop') {
                shopPage.classList.remove('hidden');
                navShop.classList.add('text-blue-900');
                navShop.classList.remove('text-gray-400');
            } else if (page === 'orders') {
                ordersPage.classList.remove('hidden');
                navOrders.classList.add('text-blue-900');
                navOrders.classList.remove('text-gray-400');
            } else if (page === 'cart') {
                cartPage.classList.remove('hidden');
                navCart.classList.add('text-blue-900');
                navCart.classList.remove('text-gray-400');
                renderCartPage();
            } else if (page === 'card') {
                cardPage.classList.remove('hidden');
                navCard.classList.add('text-blue-900');
                navCard.classList.remove('text-gray-400');
                loadCardData();
            }
        }

        // --- Card Logic ---
        function loadCardData() {
            const orders = JSON.parse(localStorage.getItem('myOrders') || '[]');
            const totalLimit = 2000;
            let usedLimit = 0;
            const today = new Date();

            let installments = JSON.parse(localStorage.getItem('myInstallments') || '[]');

            // Group by Month
            const futureInvoices = {};

            installments.forEach(inst => {
                usedLimit += inst.value;

                const key = `${inst.month}/${inst.year}`;
                if (!futureInvoices[key]) futureInvoices[key] = 0;
                futureInvoices[key] += inst.value;
            });

            // Update Limit UI (New IDs)
            const available = totalLimit - usedLimit;
            const limitDisplay = document.getElementById('card-val-avail');
            const limitBarCurrent = document.getElementById('card-bar-current');
            const limitBarFuture = document.getElementById('card-bar-future'); // Not fully utilized yet
            const limitTotalText = document.getElementById('card-limit-total-text');
            const heroInvoice = document.getElementById('card-hero-invoice');

            if (limitDisplay && limitBarCurrent) {
                if (available >= 0) {
                    limitDisplay.innerText = `DISP. ${available.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' })}`;
                    limitDisplay.className = "text-emerald-500 font-black text-xs uppercase tracking-widest";
                } else {
                    limitDisplay.innerText = `EXCEDIDO ${Math.abs(available).toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' })}`;
                    limitDisplay.className = "text-red-500 font-black text-xs uppercase tracking-widest";
                }

                const percent = (usedLimit / totalLimit) * 100;
                limitBarCurrent.style.width = `${Math.min(percent, 100)}%`;

                if (limitTotalText) limitTotalText.innerText = usedLimit.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
            }

            // Hero Invoice (Current Month or Next)
            // For now, let's sum up everything as "Open Invoice" for simplicity or take the first month
            // Let's assume the 'current open invoice' is the total of the nearest future month.
            let currentInvoiceValue = 0;
            const sortedKeys = Object.keys(futureInvoices).sort((a, b) => {
                const [ma, ya] = a.split('/');
                const [mb, yb] = b.split('/');
                return new Date(ya, ma - 1) - new Date(yb, mb - 1);
            });

            if (sortedKeys.length > 0) {
                currentInvoiceValue = futureInvoices[sortedKeys[0]];
            }
            if (heroInvoice) heroInvoice.innerText = currentInvoiceValue.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });


            // Render Carousel (New Rich UI)
            const listEl = document.getElementById('card-invoices-carousel'); // Changed to container ID

            if (listEl) {
                listEl.innerHTML = '';

                if (sortedKeys.length === 0) {
                    listEl.innerHTML = `
                        <div class="w-full text-center py-10 opacity-50">
                            <i class='bx bx-check-circle text-4xl mb-2'></i>
                            <p class="text-xs font-bold uppercase">Tudo em dia!</p>
                        </div>
                     `;
                } else {
                    const months = ["JAN", "FEV", "MAR", "ABR", "MAI", "JUN", "JUL", "AGO", "SET", "OUT", "NOV", "DEZ"];

                    sortedKeys.forEach(key => {
                        const [m, y] = key.split('/');
                        const dateObj = new Date(y, m - 1, 10);
                        const isCurrent = key === sortedKeys[0];
                        const status = isCurrent ? { txt: "ABERTA", bg: "bg-blue-50", col: "text-blue-600" } : { txt: "FUTURA", bg: "bg-slate-50", col: "text-slate-400" };
                        const valParts = futureInvoices[key].toLocaleString('pt-BR', { minimumFractionDigits: 2 }).split(',');

                        const card = document.createElement('div');
                        card.className = 'min-w-[260px] bg-white rounded-[32px] p-6 shadow-lg border border-slate-50 snap-center flex flex-col justify-between active:scale-95 transition-all';
                        // card.style.boxShadow = "0 10px 20px -5px rgba(0,0,0,0.05)";

                        card.innerHTML = `
                            <div class="flex justify-between items-start mb-6">
                                <span class="text-[10px] font-black text-slate-300 uppercase tracking-widest">${months[dateObj.getMonth()]} ${y}</span>
                                <span class="px-3 py-1 rounded-full text-[9px] font-black ${status.bg} ${status.col} uppercase tracking-widest">${status.txt}</span>
                            </div>
                            <div class="mb-6">
                                <p class="text-slate-400 text-[10px] font-black uppercase tracking-widest mb-1">Total da Fatura</p>
                                <div class="text-3xl font-black text-slate-900 tracking-tighter">
                                    <span class="text-sm">R$</span> ${valParts[0]}<span class="text-sm">,${valParts[1]}</span>
                                </div>
                            </div>
                            <div class="flex justify-between items-center pt-4 border-t border-slate-50">
                                <span class="text-[10px] font-black text-slate-400 uppercase tracking-widest">Vence ${dateObj.toLocaleDateString('pt-BR', { day: '2-digit', month: '2-digit' })}</span>
                                <i class='bx bx-right-arrow-alt text-2xl text-slate-300'></i>
                            </div>
                         `;
                        listEl.appendChild(card);
                    });
                }
            }
        }

        // Helper to render the specific Cart UI into the full page
        function renderCartPage() {
            const container = document.getElementById('cart-page');

            if (cart.length === 0) {
                container.innerHTML = `
                    <div class="text-center p-8 mt-10 animate-[fadeIn_0.5s_ease]">
                        <div class="w-24 h-24 bg-blue-50 rounded-full flex items-center justify-center mx-auto mb-6 text-blue-200">
                             <i class='bx bx-basket text-5xl'></i>
                        </div>
                        <h2 class="text-xl font-bold text-gray-800 mb-3">Seu carrinho está vazio</h2>
                        <p class="text-gray-500 mb-8 text-sm px-8">Adicione produtos para ver as melhores ofertas e cashbacks disponíveis para você.</p>
                        <button onclick="switchPage('shop')" class="px-8 py-3 bg-blue-900 text-white rounded-xl font-bold text-sm shadow-lg hover:bg-blue-800 transition-all transform hover:scale-105">
                            Começar a comprar
                        </button>
                    </div>
                 `;
                return;
            }

            let itemsHtml = '';
            let totalDueNow = 0;
            let totalCashback = 0;

            cart.forEach(item => {
                let itemTotal = 0;
                let detailsHtml = '';

                if (item.type === 'rent') {
                    const proRata = calculateProRata(item.rentPrice);
                    itemTotal = proRata.price;
                    detailsHtml = `
                        <div class="bg-blue-50 rounded px-2 py-1 mt-2 inline-flex items-center gap-2">
                             <i class='bx bx-calendar text-blue-600'></i>
                             <div>
                                <p class="text-[10px] text-blue-800 font-bold">Aluguel Pro-rata: ${itemTotal.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' })}</p>
                                <p class="text-[9px] text-blue-500">Mensal: ${item.rentPrice.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' })}</p>
                             </div>
                        </div>
                    `;
                    totalDueNow += itemTotal;
                } else {
                    // Buy
                    const price = item.basePrice;

                    if (item.installments === 1) {
                        // Full Price
                        itemTotal = price;

                        // Cashback Logic: Only if item supports > 1 installment (meaning not restricted)
                        if (item.maxInstallments > 1) {
                            const cashback = price * 0.02; // 2% Cashback
                            totalCashback += cashback;
                            detailsHtml = `
                                <div class="mt-2">
                                    <p class="text-sm font-bold text-gray-800">${itemTotal.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' })}</p>
                                    <div class="bg-yellow-100 text-yellow-800 px-2 py-1 rounded-lg text-[10px] font-bold inline-flex items-center gap-1 mt-1 border border-yellow-200">
                                        <i class='bx bx-coin-stack text-yellow-600'></i> Ganhe +${cashback.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' })} de Cashback
                                    </div>
                                </div>
                             `;
                        } else {
                            // Restricted to 1x (no cashback)
                            detailsHtml = `<p class="text-sm font-bold text-gray-800 mt-2">${itemTotal.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' })}</p>`;
                        }
                    } else {
                        // Installments
                        itemTotal = price / item.installments;
                        detailsHtml = `<p class="text-sm font-bold text-gray-800 mt-2">${item.installments}x de ${itemTotal.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' })}</p>`;
                    }
                    totalDueNow += itemTotal;
                }

                // Controls
                let typeSelect = '';
                if (item.rentPrice > 0) {
                    typeSelect = `
                        <select onchange="updateItemType('${item.id}', this.value)" class="text-[10px] border border-gray-200 rounded px-2 py-1 bg-white text-gray-700 font-bold focus:outline-none focus:border-blue-500 shadow-sm h-8">
                            <option value="buy" ${item.type === 'buy' ? 'selected' : ''}>Comprar</option>
                            <option value="rent" ${item.type === 'rent' ? 'selected' : ''}>Alugar</option>
                        </select>
                     `;
                }

                let installSelect = '';
                if (item.type === 'buy' && item.maxInstallments > 1) {
                    let opts = '';
                    for (let i = 1; i <= item.maxInstallments; i++) {
                        opts += `<option value="${i}" ${item.installments === i ? 'selected' : ''}>${i}x</option>`;
                    }
                    installSelect = `
                        <select onchange="updateItemInstallments('${item.id}', this.value)" class="text-[10px] border border-gray-200 rounded px-2 py-1 bg-white text-gray-700 font-bold ml-2 focus:outline-none focus:border-blue-500 shadow-sm h-8">
                            ${opts}
                        </select>
                    `;
                }

                itemsHtml += `
                    <div class="flex gap-4 p-4 bg-white border border-gray-100 rounded-2xl shadow-sm hover:shadow-md transition-all animate-[fadeIn_0.3s_ease]">
                        <div class="w-16 h-16 bg-white rounded-xl border border-gray-100 flex items-center justify-center p-1 shrink-0 overflow-hidden shadow-inner">
                             ${item.img ? `<img src="${item.img}" class="w-full h-full object-contain">` : `<i class='bx bx-package text-gray-300 text-2xl'></i>`}
                        </div>
                        <div class="flex-1 min-w-0">
                            <div class="flex justify-between items-start mb-2">
                                <h4 class="text-sm font-bold text-gray-800 line-clamp-2 leading-snug">${item.name}</h4>
                                <button onclick="removeFromCart('${item.id}')" class="text-gray-400 hover:text-red-500 p-1 -mt-1 -mr-1"><i class='bx bx-trash'></i></button>
                            </div>
                            
                            <div class="flex flex-wrap items-center gap-2 mb-1">
                                ${typeSelect}
                                ${installSelect}
                            </div>
                            
                            ${detailsHtml}
                        </div>
                    </div>
                `;
            });

            container.innerHTML = `
                <div class="flex items-center justify-between mb-6">
                     <h2 class="text-xl font-bold text-gray-800">Meu Carrinho</h2>
                     <span class="bg-blue-100 text-blue-800 text-xs font-bold px-3 py-1 rounded-full">${cart.length} item(s)</span>
                </div>

                <div class="space-y-4 mb-32">
                    ${itemsHtml}
                    
                    <div class="bg-white p-6 rounded-3xl shadow-lg border border-gray-100 mt-8">
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-sm text-gray-500">Valor dos produtos</span>
                            <span class="text-sm font-bold text-gray-800">${totalDueNow.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' })}</span>
                        </div>
                        
                        ${totalCashback > 0 ? `
                        <div class="flex justify-between items-center mb-4 bg-yellow-50 p-3 rounded-xl border border-yellow-100">
                            <div class="flex items-center gap-2">
                                <div class="w-6 h-6 rounded-full bg-yellow-200 flex items-center justify-center text-yellow-700 text-xs">
                                    <i class='bx bx-coin-stack'></i>
                                </div>
                                <span class="text-xs text-yellow-800 font-bold">Cashback a receber</span>
                            </div>
                            <span class="text-sm font-bold text-yellow-700">+${totalCashback.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' })}</span>
                        </div>
                        ` : ''}
                        
                        <div class="border-t border-gray-100 my-4"></div>
                        
                        <div class="flex justify-between items-end mb-6">
                            <span class="text-sm font-medium text-gray-600">Total a Pagar</span>
                            <h2 class="text-2xl font-bold text-blue-900 leading-none">${totalDueNow.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' })}</h2>
                        </div>
                        
                         <div id="payment-area">
                            <button id="btnGerarPix" onclick="startPurchaseAnimation()" class="w-full bg-blue-900 text-white py-4 rounded-xl font-bold text-base shadow-xl shadow-blue-200 hover:shadow-blue-300 hover:scale-[1.02] active:scale-[0.98] transition-all flex items-center justify-center gap-2">
                                <i class='bx bx-lock-alt'></i> Pagar com Pix ou Cartão
                            </button>
                        </div>
                        
                        <p class="text-[10px] text-center text-gray-400 mt-4 flex items-center justify-center gap-1">
                            <i class='bx bx-shield-quarter'></i> Pagamento processado com segurança
                        </p>
                    </div>
                </div>
            `;
        }

        function renderCartItems() {
            renderCartPage();
        }

        // --- Payment Generation (Bulk) ---

        async function startPurchaseAnimation() {
            // Animation logic reusing existing structure elements
            // Note: need to ensure the overlay divs exist in HTML (they do)
            const overlay = document.getElementById('purchase-overlay');
            const sphere = document.getElementById('purchase-sphere');
            const content = document.getElementById('purchase-content');

            sphere.style.transform = 'scale(0)';
            content.classList.remove('opacity-100');
            content.classList.add('opacity-0');
            overlay.classList.remove('hidden');
            overlay.classList.add('flex');
            void sphere.offsetWidth;
            sphere.style.transform = 'scale(150)';

            setTimeout(() => {
                content.classList.remove('opacity-0');
                content.classList.add('opacity-100');
            }, 100);

            await new Promise(resolve => setTimeout(resolve, 3000));
            content.classList.remove('opacity-100');
            content.classList.add('opacity-0');

            await gerarPagamento();

            setTimeout(() => {
                sphere.style.transform = 'scale(0)';
                setTimeout(() => {
                    overlay.classList.add('hidden');
                    overlay.classList.remove('flex');
                }, 700);
            }, 300);
        }

        async function gerarPagamento() {
            // Directly confirm payment logic instead of API simulation for Card flow consistency
            // In a real app we would choose method. Here we default to success flow.
            confirmarPagamento();
        }

        function confirmarPagamento() {
            const storedOrders = JSON.parse(localStorage.getItem('myOrders') || '[]');
            const storedInstallments = JSON.parse(localStorage.getItem('myInstallments') || '[]');

            cart.forEach(item => {
                let priceDisplay = 0;
                if (item.type === 'rent') {
                    priceDisplay = calculateProRata(item.rentPrice).price;
                } else {
                    priceDisplay = item.basePrice;
                }

                // Add Installments
                if (item.type === 'buy' && item.installments > 1) {
                    const monthlyValue = item.basePrice / item.installments;
                    const startMonth = new Date().getMonth() + 2; // Next Month start
                    let year = new Date().getFullYear();

                    for (let i = 0; i < item.installments; i++) {
                        let m = startMonth + i;
                        let y = year;
                        if (m > 12) { m -= 12; y++; }

                        storedInstallments.push({
                            name: item.name,
                            value: monthlyValue,
                            month: m,
                            year: y
                        });
                    }
                }

                storedOrders.unshift({
                    id: 'ORD-' + Math.floor(Math.random() * 1000000),
                    name: `${item.name} (${item.type === 'rent' ? 'Aluguel' : item.installments + 'x'})`,
                    price: priceDisplay,
                    status: 'Em separação',
                    date: new Date().toLocaleDateString('pt-BR')
                });
            });

            localStorage.setItem('myOrders', JSON.stringify(storedOrders));
            localStorage.setItem('myInstallments', JSON.stringify(storedInstallments));

            cart = [];
            updateCartIcon();

            switchPage('orders');
            loadOrders();
            showToast('Pedido realizado com sucesso!', 'success');
        }

        // --- View & Navigation Utils ---

        function loadOrders() {
            const orders = JSON.parse(localStorage.getItem('myOrders') || '[]');
            const container = document.getElementById('dynamic-orders');
            if (!container) return;

            if (orders.length === 0) {
                container.innerHTML = '';
                return;
            }

            let html = '';
            orders.forEach(order => {
                const isTwoTimes = order.name.includes('2x');
                html += `
                <div class="bg-white rounded-2xl p-5 shadow-sm mb-4 border border-gray-100 animate-[fadeIn_0.5s_ease]">
                    <div class="flex gap-4">
                        <div class="w-16 h-16 bg-gray-50 rounded-xl flex items-center justify-center text-gray-600 border border-gray-100">
                            <i class='bx bx-package text-2xl'></i>
                        </div>
                        <div class="flex-1">
                            <p class="text-[10px] uppercase font-bold text-blue-900 mb-1 tracking-wide">Em separação</p>
                            <h3 class="text-sm font-bold text-gray-800 leading-tight">${order.name}</h3>
                            <p class="text-xs text-gray-500 mt-1">${order.price.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' })}</p>
                        </div>
                    </div>
                     <div class="mt-4 pt-4 border-t border-gray-100">
                         <div>
                            <p class="text-xs font-bold text-gray-700">Status atual:</p>
                            <div class="flex items-center gap-2 mt-1">
                                <i class='bx bx-loader-alt bx-spin text-blue-600'></i>
                                <span class="text-xs text-gray-500">Estamos separando seu pedido.</span>
                            </div>
                        </div>
                    </div>
                </div>`;
            });
            container.innerHTML = html;
        }

        function showToast(msg, type) {
            const t = document.createElement('div');
            t.className = 'toast';
            t.style.background = type === 'success' ? '#22c55e' : '#1e3a8a';
            t.style.color = 'white';
            t.style.padding = '12px 20px';
            t.style.borderRadius = '50px';
            t.style.fontSize = '0.9rem';
            t.style.fontWeight = '600';
            t.style.boxShadow = '0 5px 15px rgba(0,0,0,0.2)';
            t.style.zIndex = '9999';
            t.innerHTML = `<span>${msg}</span>`;

            if (toastContainer) {
                toastContainer.appendChild(t);
                t.animate([{ transform: 'translateY(20px)', opacity: 0 }, { transform: 'translateY(0)', opacity: 1 }], { duration: 300, fill: 'forwards' });
                setTimeout(() => {
                    t.animate([{ opacity: 1 }, { opacity: 0 }], { duration: 300, fill: 'forwards' }).onfinish = () => t.remove();
                }, 3000);
            }
        }

        // --- Invoice Modal ---
        function openInvoice() {
            window.open('https://drive.google.com/file/d/1GQjQOw7xq9Y52B-NY9p8gtPr9HK4eGzE/view?usp=sharing', '_blank');
        }

        function closeInvoice() {
            // no op
        }


        // Modal helpers for general purpose if needed (though we removed the cart modal usage)
        function fecharModal() {
            document.getElementById('modalPagamento').style.display = 'none';
        }

        // Init
        loadOrders();
        updateCartIcon();
    </script>

</body>

</html>