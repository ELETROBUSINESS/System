function extrairTagXML(xmlString, tag) {
    if (!xmlString || xmlString === "" || xmlString === "---") return null;
    const regex = new RegExp(`<([a-zA-Z0-9]+:)?${tag}>(.*?)<\/[a-zA-Z0-9:]*?${tag}>`, 'i');
    const match = xmlString.match(regex);
    return match ? match[2] : null;
}

const xmlExemplo = `<?xml version="1.0" encoding="UTF-8"?><nfeProc xmlns="http://www.portalfiscal.inf.br/nfe" versao="4.00"><NFe xmlns="http://www.portalfiscal.inf.br/nfe"><infNFe Id="NFe15260145692327000100650010000004431866017748" versao="4.00"><ide><cUF>15</cUF><cNF>86601774</cNF><natOp>Venda Dentro do Estado</natOp><mod>65</mod><serie>1</serie><nNF>443</nNF><dhEmi>2026-01-13T18:19:56-03:00</dhEmi><tpNF>1</tpNF><idDest>1</idDest><cMunFG>1503457</cMunFG><tpImp>4</tpImp><tpEmis>1</tpEmis><cDV>8</cDV><tpAmb>1</tpAmb><finNFe>1</finNFe><indFinal>1</indFinal><indPres>1</indPres><procEmi>0</procEmi><verProc>EmissorDtudo1.0</verProc></ide><emit><CNPJ>45692327000100</CNPJ><xNome>A N F da Silva LTDA</xNome><enderEmit><xLgr>RUA JARBAS PASSARINHO</xLgr><nro>SN</nro><xBairro>CENTRO</xBairro><cMun>1503457</cMun><xMun>IPIXUNA DO PARA</xMun><UF>PA</UF><CEP>68637000</CEP><cPais>1058</cPais><fone>91992375194</fone></enderEmit><IE>158228057</IE><CRT>1</CRT></emit><det nItem="1"><prod><cProd>7897252250009</cProd><cEAN>SEM GTIN</cEAN><xProd>BRINQUEDO.CAMINHAO MINI TRUCK TRANSCAR SILMAR</xProd><NCM>95030099</NCM><CFOP>5102</CFOP><uCom>UN</uCom><qCom>1</qCom><vUnCom>28.0000</vUnCom><vProd>28.00</vProd><cEANTrib>SEM GTIN</cEANTrib><uTrib>UN</uTrib><qTrib>1</qTrib><vUnTrib>28.0000</vUnTrib><indTot>1</indTot></prod><imposto><vTotTrib>0.00</vTotTrib><ICMS><ICMSSN102><orig>0</orig><CSOSN>102</CSOSN></ICMSSN102></ICMS><PIS><PISOutr><CST>49</CST><vBC>0.00</vBC><pPIS>0.00</pPIS><vPIS>0.00</vPIS></PISOutr></PIS><COFINS><COFINSOutr><CST>49</CST><vBC>0.00</vBC><pCOFINS>0.0000</pCOFINS><vCOFINS>0.00</vCOFINS></COFINSOutr></COFINS></imposto></det><total><ICMSTot><vBC>0.00</vBC><vICMS>0.00</vICMS><vICMSDeson>0.00</vICMSDeson><vFCPUFDest>0.00</vFCPUFDest><vICMSUFDest>0.00</vICMSUFDest><vICMSUFRemet>0.00</vICMSUFRemet><vFCP>0.00</vFCP><vBCST>0.00</vBCST><vST>0.00</vST><vFCPST>0.00</vFCPST><vFCPSTRet>0.00</vFCPSTRet><vProd>28.00</vProd><vFrete>0.00</vFrete><vSeg>0.00</vSeg><vDesc>0.00</vDesc><vII>0.00</vII><vIPI>0.00</vIPI><vIPIDevol>0.00</vIPIDevol><vPIS>0.00</vPIS><vCOFINS>0.00</vCOFINS><vOutro>0.00</vOutro><vNF>28.00</vNF><vTotTrib>0.00</vTotTrib></ICMSTot></total><transp><modFrete>9</modFrete></transp><pag><detPag><indPag>1</indPag><tPag>01</tPag><vPag>30.00</vPag></detPag><vTroco>2.00</vTroco></pag><infAdic><infCpl>DOCUMENTO EMITIDO POR ME OU EPP OPTANTE PELO SIMPLES NACIONAL.</infCpl></infAdic><infRespTec><CNPJ>00330845000145</CNPJ><xContato>Suporte</xContato><email>suporte@dtudo.com.br</email><fone>91992375194</fone></infRespTec></infNFe><infNFeSupl xmlns="http://www.portalfiscal.inf.br/nfe"><qrCode><![CDATA[https://appnfc.sefa.pa.gov.br/portal/view/consultas/nfce/nfceForm.seam?p=15260145692327000100650010000004431866017748|2|1|1|1B41470EDF551CC4EDB4A85AC92364BE7683E280]]></qrCode><urlChave>www.sefa.pa.gov.br/nfce/consulta</urlChave></infNFeSupl><Signature xmlns="http://www.w3.org/2000/09/xmldsig#"><SignedInfo xmlns="http://www.w3.org/2000/09/xmldsig#"><CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"></CanonicalizationMethod><SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1"></SignatureMethod><Reference URI="#NFe15260145692327000100650010000004431866017748"><Transforms><Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"></Transform><Transform Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"></Transform></Transforms><DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"></DigestMethod><DigestValue>nVfnXXHX7jdSSGpkRVzzFpk4kDc=</DigestValue></Reference></SignedInfo><SignatureValue>mgbCZAF/QM/iRxdEcxA39We9mr/102ljSB6/mQVP+tSMe2+S46QjBRNGZfSDaMeJfwHN3iDYS4842B3VIuAn5rvZG3TlYWLnRDpb1S/qLY+YSluVjiytLcvN4y/tNzot5CMrgqlXVkyb7GHJizD8QIskmTVn2nd+lOl00qQsGAwpQhAVXNhM2JDDd51yFrh4u5Y0Wsgqaxo5BpHMmuGW8INI4SH7u6b6GpaIUApJkKhuF3s5htbmWpqwELJgACuMI1PdQsbWGR2kZRjzWUY6xQH3Mg2z8HnTE4bC3OvglPxTGqS0VcnPVVoKXYRAelqYDNEgICal2t/xq5+2QGRSfw==</SignatureValue><KeyInfo><X509Data><X509Certificate>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</X509Certificate></X509Data></KeyInfo></Signature></NFe><protNFe versao="4.00"><infProt><tpAmb>1</tpAmb><verAplic>SVRSnfce2512111137DR</verAplic><chNFe>15260145692327000100650010000004431866017748</chNFe><dhRecbto>2026-01-13T18:19:56-03:00</dhRecbto><nProt>215260025866596</nProt><digVal>nVfnXXHX7jdSSGpkRVzzFpk4kDc=</digVal><cStat>100</cStat><xMotivo>Autorizado o uso da NF-e</xMotivo></infProt></protNFe></nfeProc>`

const dhEmi = extrairTagXML(xmlExemplo, "dhEmi");
const vNF = extrairTagXML(xmlExemplo, "vNF");
console.log("Data:", dhEmi);
console.log("Valor:", vNF);
